# Default values for gthulhu.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Gthulhu Scheduler Configuration
scheduler:
  enabled: true
  replicaCount: 1
  
  image:
    repository: 127.0.0.1:5000/gthulhu
    pullPolicy: IfNotPresent
    tag: "latest"
  
  # Scheduler requires privileged access for BPF operations
  securityContext:
    privileged: true
    runAsUser: 0
    capabilities:
      add:
        - SYS_ADMIN
        - SYS_RESOURCE
        - SYS_PTRACE
  
  # Host PID namespace is required for scheduler operations
  hostPID: true
  
  # Node selector to ensure deployment on nodes with required kernel version
  nodeSelector:
    kubernetes.io/os: linux
  
  # Resources for the scheduler
  resources:
    limits:
      # cpu: 500m
      memory: 512Mi
    requests:
      # cpu: 100m
      memory: 128Mi
  
  # Tolerations to allow scheduling on any node
  tolerations:
    - operator: Exists

# Metrics API Server Configuration
api:
  enabled: false
  replicaCount: 1
  
  image:
    repository: gthulhu-api
    pullPolicy: IfNotPresent
    tag: "latest"
  
  # API server port configuration
  port: 8080
  targetPort: 8080
  
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    readOnlyRootFilesystem: true
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
  
  # Service configuration
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  
  # Ingress configuration
  ingress:
    enabled: false
    className: ""
    annotations: {}
      # kubernetes.io/ingress.class: nginx
      # kubernetes.io/tls-acme: "true"
    hosts:
      - host: gthulhu-api.local
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls: []
    #  - secretName: gthulhu-api-tls
    #    hosts:
    #      - gthulhu-api.local
  
  # Health check configuration
  healthCheck:
    enabled: true
    path: /health
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  
  # Resources for the API server
  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 64Mi
  
  # Horizontal Pod Autoscaler
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80

# Global configuration
global:
  imagePullSecrets: []
  nameOverride: ""
  fullnameOverride: ""

# Service Account
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# Pod annotations
podAnnotations: {}

# Additional labels for all resources
additionalLabels: {}

# Node selector for all components (can be overridden per component)
nodeSelector: {}

# Tolerations for all components (can be overridden per component)
tolerations: []

# Affinity for all components (can be overridden per component)  
affinity: {}

# Storage configuration for metrics (if needed in future)
persistence:
  enabled: false
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 10Gi

# Monitoring and observability
monitoring:
  enabled: false
  serviceMonitor:
    enabled: false
    labels: {}
    interval: 30s
    path: /metrics
